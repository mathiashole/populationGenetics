---
title: "EJERCICIOS P1"
date: today
date-format: "DD MMMM, YYYY"
author: 
  Mathias
abstract:
    Genetica de poblaciones
abstractspacing: double
appendix: false
fontfamily: libertine
monofont: inconsolata
monofontoptions: scaled=.95
fontsize: 12pt
geometry: 
  - top=2cm
  - bottom=2cm
  - left=2cm
  - right=2cm
urlcolor: darkblue
highlight-style: arrow
format: 
    pdf:
      toc: true
      number-sections: true
      colorlinks: true
---

# Ejercicio 5: Estudio farmaceutico

1. La frecuencia de un alelo autos贸mico A en una poblaci贸n es p = 0.1.
驴Cu谩l es el n煤mero esperado de alelos A en una muestra de 20 alelos?
驴Cu谩l es la probabilidad de no observar el alelo A en la muestra?
2. Utilizando la funci贸n rbinom, simule un gran n煤mero de muestras de tama帽o n = 20 y
caracterice la distribuci贸n de los resultados utilizando descriptores gr谩ficos y num茅ricos
apropiados.
3. Considere ahora el caso de f(A) = p = 0.01.驴Cu谩l es la probabilidad de observar el alelo
A en una muestra de n = 20?
4. La frecuencia observada de un alelo autos贸mico diploide A es 3/10 (tama帽o de la
muestra n = 10). Utilice dbinom para calcular la probabilidad de observar esta frecuencia
en la muestra para un rango de frecuencias subyacentes en la poblaci贸n entre 0,01 y
0,99.
5. Genotipos como muestras aleatorias de tama帽o n = 2. Para un locus autos贸mico
diploide con dos alelos, describa las proporciones de HW como esperanzas de la
distribuci贸n binomial.
6. Para una muestra de n = 10 individuos, obtenga la frecuencia esperada de
heterocigotos para f(A) = 0.3 y utilice rbinom para simular un gran n煤mero de muestras
y caracterizar la variaci贸n aleatoria de la frecuencia observada de heterocigotos.
7. nota: el 3 muestra (no demuestra) que $MLE(p) = \hat{p}$
8. Para n=4, obtener en R una simulaci贸n de todos los componentes del proceso
coalescente. Asumir que $N = 5\times 10^{5}$ y $\mu = 10-5$. Para la realizaci贸n obtenida, calcular $\pi$, $S$
y w.
9. Structure:
El programa structure se corri贸 con $K = 2$ y 90 genotipos, y la cadena de MCMC par贸 en la
generaci贸n $m-1$. Nos enfocamos en un s贸lo locus con alelos.
El estado de la cadena en $m-1$ es el siguiente:
Frecuencias del alelo de referencia en cada subpoblaci贸n:
$P(m-1)1 = 0.5$, $P(m-1)2 = 0.8$.
Ubicaci贸n de los genotipos a subpoblaciones:
Subpoblaci贸n 1 Subpoblaci贸n 2
$答$ 13 25
$答$ 24 13
$$ 13 2
Total 50 40
a) Usando una distribuci贸n apropiada, obtener valores propuestos de para la $P$
generaci贸n $m[P(m)]$ para cada subpoblaci贸n. Explicar, en cada caso, si deber铆an ser 
aceptadas como los nuevos valores $P(m)_{1}$ y $P(m)_{2}$ y con qu茅 regla de
probabilidad.
b) Ahora considerar un genotipo que puede moverse de la subpoblaci贸n 1 a la 2.答
Explicar c贸mo se toma la decisi贸n de moverlo o no.
En las respuestas, incluir tanto las explicaciones como el c贸digo de R o los c谩lculos
equivalentes.

## Construir un diagrama de tallos y hojas (extendido) para estos tiempos.

| Stem | Leaf |
|------|------|
| 0    | 9    |
| 1    | 0 0 1 1 2 2 3 3 4 5 5 5 6 7 8 8 8 9 9 9 |
| 2    | 0 0 1 1 2 3 4 6 |

## Construir una tabla de frecuencias y densidades para estos tiempos.

```{r}
# Cargar los tiempos
tiempos <- c(15, 18, 19, 21, 23, 26, 17, 18, 24, 20, 13, 10, 16, 11, 9,
             12, 14, 10, 19, 13, 20, 15, 11, 18, 15, 21, 12, 19, 18, 22)

# Crear los intervalos de 5 unidades
intervalos <- seq(0, 30, by = 5) # avanza de 5 en 5 de 0 a 30

# Tabla de frecuencias
tabla_frecuencias <- cut(tiempos, breaks = intervalos, right = FALSE) # Divide los 
# datos en intervalos ("bins"), para eso se usa cut
frecuencia <- table(tabla_frecuencias) # Crea una tabla que tiene el conteo de cada
# categoria, en este caso intervalos

# Densidades (frecuencia / tama帽o del intervalo)
densidad <- prop.table(frecuencia) # Partiendo de la tabla de frecuencias esta 
# funcion se usa para calcular la densidad de frecuencias

# Mostrar la tabla de frecuencias y densidades
tabla_resultado <- data.frame(Intervalo = names(frecuencia),
    Frecuencia = as.vector(frecuencia),
    Densidad = as.vector(densidad))
print(tabla_resultado)

```


## Dibujar un histograma para estos tiempos dividiendo el intervalo [0, 30] en 6 intervalos de longitud 5 en escala frecuencia y en escala densidad.

```{r}

library(ggplot2)

# Crear el dataframe para ggplot
df_tiempos <- data.frame(tiempos) # vector a dataframe

# Histograma en escala de frecuencia
ggplot(df_tiempos, aes(x = tiempos)) +
  geom_histogram(breaks = intervalos, # intervalos para separar
                  fill = "lightblue", # relleno
                  color = "black") + # borde
  labs(title = "Histograma de Frecuencia", x = "Tiempos", y = "Frecuencia") +
  theme_minimal()

# Histograma en escala de densidad
ggplot(df_tiempos, aes(x = tiempos)) +
  geom_histogram(aes(y = after_stat(density)),
   breaks = intervalos,
   fill = "lightgreen", # relleno
   color = "black") + # borde
  geom_density() + # agrega capa de densidad
  labs(title = "Histograma de Densidad", x = "Tiempos", y = "Densidad") +
  theme_minimal()

```

# Ejercicio 7: Tablas de contingencia II

|         | Caf茅 | T茅 | Refresco |
|---------|------|----|----------|
| Hombres | 50 | 30 | 20 |
| Mujeres | 40 | 45 | 15 |

Tabla 1: Tabla de contingencia de preferencias de bebidas por g茅nero.

La hip贸tesis a probar es la siguiente:

Hip贸tesis nula $H_0$: No existe dependencia entre el g茅nero y la preferencia de bebida.
Hip贸tesis alternativa $H_1$: Existe dependencia entre el g茅nero y la preferencia de bebida.

```{r}
# Datos observados
observados <- matrix(c(50, 30, 20, 40, 45, 15), nrow = 2, byrow = TRUE)

# Realizar el test chi-cuadrado
test_chi2 <- chisq.test(observados)

# Resultado del test
test_chi2

```

No hay suficiente evidencia para rechazar la $H_0$.


## C谩lculo del estad铆stico $\chi^2$ sin usar funcion de R:

La prueba $\chi^2$ que da el valor de X-squared, se calcula usando la ecuacion

$$
\chi^2 = \sum_{i=1}^{r} \sum_{j=1}^{c} \frac{(O_{ij} - E_{ij})^2}{E_{ij}}
$$

Donde $O_{ij}$ son las frecuencias observadas y $E_{ij}$ son las frecuencias esperadas.

$$
\chi^2 = \frac{(50 - 45)^2}{45} + \frac{(30 - 37.5)^2}{37.5} + \frac{(20 - 17.5)^2}{17.5} + \frac{(40 - 45)^2}{45} + \frac{(45 - 37.5)^2}{37.5} + \frac{(15 - 17.5)^2}{17.5}
$$

Siendo

$$
\chi^2 = \frac{25}{45} + \frac{56.25}{37.5} + \frac{6.25}{17.5} + \frac{25}{45} + \frac{56.25}{37.5} + \frac{6.25}{17.5} = 0.556 + 1.5 + 0.357 + 0.556 + 1.5 + 0.357 = 4.826
$$

Los grados de libertad se calculan segun los numeros de r = row (fila) y c = column (columna):

$$
\text{gl} = (r - 1)(c - 1) = (2 - 1)(3 - 1) = 2
$$

El valor de la tabla ($\chi^2$) para un nivel de significancia ($\alpha = 0.05$) y 2 grados de libertad es aproximadamente 5.99. Ver tabla $\chi^2$

Como el estad铆stico calculado ($\chi^2 = 4.826$) es menor que 5.99, no rechazamos la hip贸tesis nula.
